<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DREAM_ECHO_NFT_DEMO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Model Viewer -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <!-- 引入 html2canvas 用于截图 -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@900&family=Space+Mono:wght@400;700&display=swap');
        
        body {
            background-color: #000000;
            color: #FFFFFF;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            overflow-y: auto;
        }

        /* 粗犷主义字体风格 */
        .ye-font {
            font-family: 'Inter', sans-serif;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: -0.05em;
            line-height: 0.9;
        }

        .mono-font {
            font-family: 'Space Mono', monospace;
            letter-spacing: -0.02em;
        }

        /* 噪点纹理背景 */
        .noise-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.15;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
        }

        /* 荧光绿高亮 */
        .ye-highlight {
            color: #BEFF00; 
        }
        .ye-bg {
            background-color: #BEFF00;
            color: black;
        }

        /* 极简边框卡片 */
        .brutalist-card {
            border: 1px solid #333;
            background: #050505;
            position: relative;
            z-index: 10;
            transition: border-color 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .brutalist-card:hover {
            border-color: #666;
        }

        /* Model Viewer 自定义样式 */
        model-viewer {
            width: 100%;
            height: 100%;
            background-color: #111; /* Slightly lighter background to see silhouette if dark */
            --poster-color: #111;
        }
        
        /* 截图按钮样式 - HIDDEN FOR DEMO
        .capture-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 50;
            font-family: 'Space Mono', monospace;
            font-size: 0.65rem;
            background-color: rgba(0,0,0,0.8);
            color: #666;
            padding: 4px 8px;
            border: 1px solid #333;
            cursor: pointer;
            transition: all 0.2s;
            opacity: 0;
        }
        .brutalist-card:hover .capture-btn {
            opacity: 1;
        }
        .capture-btn:hover {
            background-color: #BEFF00;
            color: black;
            border-color: #BEFF00;
        } */

        /* 加载层样式 */
        .loader-overlay {
            position: absolute;
            inset: 0;
            background-color: #050505;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
            transition: opacity 0.5s ease-out;
            pointer-events: none; /* 允许点击穿透，虽然显示时不需要 */
        }
        .loader-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="w-full min-h-screen flex flex-col items-center py-20 gap-10">

    <div class="noise-bg"></div>

    <header class="flex flex-col items-center gap-2 mb-10 z-10">
        <h1 class="ye-font text-5xl md:text-7xl text-center">DREAM_ARCHIVE</h1>
        <p class="mono-font text-xs text-gray-500 tracking-[0.2em]">SEASON 1 // SIMULATION</p>
    </header>

    <!-- Grid Container -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 z-10 px-8">

        <!-- Card 1: LUCID -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">MINTED</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#8A291F</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                
                <model-viewer 
                    src="1fd9247a80213b623636aecb11b58500.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">LUCID</h2>
                    <span class="mono-font text-xs font-bold">VOL. 1</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">CLARITY: 85%</span>
                </div>
            </div>
        </div>

        <!-- Card 2: REM -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">PENDING</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#2B9X01</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                <model-viewer 
                    src="6298de6263fd188c016dcc8e5fcbcbb6.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">REM</h2>
                    <span class="mono-font text-xs font-bold">VOL. 2</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">CHAOS: 42%</span>
                </div>
            </div>
        </div>

        <!-- Card 3: LIMBO -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">MINTED</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#99A0C2</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                <model-viewer 
                    src="a4a862dbb9f374dfa146a03d308c53d3.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">LIMBO</h2>
                    <span class="mono-font text-xs font-bold">VOL. 3</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">NULL: 00%</span>
                </div>
            </div>
        </div>

        <!-- Card 4: ASTRAL -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">MINTED</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#FF009A</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                <model-viewer 
                    src="a6ffab65aef704861d661684318953c5.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">ASTRAL</h2>
                    <span class="mono-font text-xs font-bold">VOL. 4</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">ASCENSION: 99%</span>
                </div>
            </div>
        </div>

        <!-- Card 5: MIRAGE -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">LOCKED</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#X7721B</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                <model-viewer 
                    src="c841b149a404db23f5673a6f617855c3.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">MIRAGE</h2>
                    <span class="mono-font text-xs font-bold">VOL. 5</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">HAZE: 60%</span>
                </div>
            </div>
        </div>

        <!-- Card 6: NIGHTMARE -->
        <div class="brutalist-card w-[350px] h-[500px] flex flex-col justify-between p-0 group">
            <!-- <button onclick="captureCard(this)" class="capture-btn">[ SAVE_CARD ]</button> -->
            <div class="flex justify-between items-start p-4 border-b border-[#222]">
                <div class="flex flex-col">
                    <span class="mono-font text-[10px] text-gray-400">STATUS</span>
                    <span class="ye-font text-xl ye-highlight">MINTED</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="mono-font text-[10px] text-gray-400">BLOCK</span>
                    <span class="mono-font text-xs">#44091D</span>
                </div>
            </div>
            <div class="flex-1 relative model-container">
                <!-- 加载进度条 -->
                <div class="loader-overlay">
                    <div class="w-[120px] h-[2px] bg-[#222] mb-3">
                        <div class="progress-bar h-full bg-[#BEFF00] w-0 transition-all duration-100"></div>
                    </div>
                    <span class="progress-text mono-font text-[10px] text-[#BEFF00] tracking-widest">LOADING // 0%</span>
                </div>
                <model-viewer 
                    src="d38f6bd08abcf9d8e8fe3c4752586613.glb" 
                    camera-controls 
                    auto-rotate 
                    shadow-intensity="2" 
                    exposure="1.5"
                    environment-image="neutral">
                </model-viewer>
            </div>
            <div class="bg-white text-black p-4 flex flex-col gap-1">
                <div class="flex justify-between items-baseline">
                    <h2 class="ye-font text-4xl leading-none">TERROR</h2>
                    <span class="mono-font text-xs font-bold">VOL. 6</span>
                </div>
                <div class="flex justify-between items-end border-t border-black pt-2 mt-1">
                    <span class="mono-font text-[10px] font-bold">WU JIAJUN</span>
                    <span class="mono-font text-sm font-bold tracking-tighter">DREAD: 95%</span>
                </div>
            </div>
        </div>

    </div>
    
    <footer class="mono-font text-xs text-gray-500 mb-10">
        ARCHIVE_ID: 2024_DREAM_ECHO_NFT_DEMO // END OF LINE
    </footer>

    <script>
        // 截图脚本
        async function captureCard(btn) {
            const card = btn.closest('.brutalist-card');
            const modelViewer = card.querySelector('model-viewer');
            const loader = card.querySelector('.loader-overlay');
            
            const originalText = btn.innerText;
            btn.innerText = '[ PROCESSING... ]';
            btn.style.opacity = '0';
            
            // 截图时确保加载条不显示
            if(loader) loader.style.display = 'none';

            try {
                const modelUrl = modelViewer.toDataURL('image/png');
                
                const img = document.createElement('img');
                img.src = modelUrl;
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'contain';
                img.style.backgroundColor = '#111';
                img.style.position = 'absolute';
                img.style.top = '0';
                img.style.left = '0';
                
                const parent = modelViewer.parentNode;
                parent.appendChild(img);
                modelViewer.style.opacity = '0';
                
                const canvas = await html2canvas(card, {
                    backgroundColor: null, 
                    scale: 2, 
                    useCORS: true
                });
                
                const link = document.createElement('a');
                const title = card.querySelector('h2').innerText;
                link.download = `DREAM_ECHO_${title}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                img.remove();
                modelViewer.style.opacity = '1';
                
            } catch (err) {
                console.error('Screenshot failed:', err);
                alert('Screenshot failed. Please try again.');
            } finally {
                if(loader) loader.style.display = ''; // 恢复加载条样式（如果还在加载的话）
                btn.style.opacity = ''; 
                btn.innerText = originalText;
            }
        }

        // 加载进度脚本
        document.querySelectorAll('.model-container').forEach(container => {
            const viewer = container.querySelector('model-viewer');
            const overlay = container.querySelector('.loader-overlay');
            const progressBar = container.querySelector('.progress-bar');
            const progressText = container.querySelector('.progress-text');

            // 函数：隐藏遮罩层
            const hideOverlay = () => {
                if (overlay && !overlay.classList.contains('hidden')) {
                    overlay.classList.add('hidden');
                    setTimeout(() => {
                        if (overlay.parentNode) {
                            overlay.remove();
                        }
                    }, 500);
                }
            };

            // 监听加载进度
            viewer.addEventListener('progress', (event) => {
                const percentage = Math.round(event.detail.totalProgress * 100);
                progressBar.style.width = `${percentage}%`;
                progressText.innerText = `LOADING // ${percentage}%`;
                
                if (percentage === 100) {
                    setTimeout(hideOverlay, 500);
                }
            });

            // 监听加载完成事件 (双重保险)
            viewer.addEventListener('load', hideOverlay);
            
            // 监听错误事件
            viewer.addEventListener('error', (error) => {
                console.error('Model failed to load:', error);
                progressText.innerText = 'ERROR // FAILED';
                progressText.style.color = 'red';
                progressBar.style.backgroundColor = 'red';
            });
            
            // 防止已经加载完的情况
            if(viewer.loaded) {
                hideOverlay();
            }
        });
    </script>

</body>
</html>